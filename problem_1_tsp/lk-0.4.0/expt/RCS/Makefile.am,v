head	1.8;
access;
symbols
	zero-four-zero:1.8;
locks
	neto:1.8;
comment	@# @;


1.8
date	97.11.22.17.58.15;	author neto;	state Exp;
branches;
next	1.7;

1.7
date	97.11.22.16.25.26;	author neto;	state Exp;
branches;
next	1.6;

1.6
date	97.11.07.22.20.08;	author neto;	state Exp;
branches;
next	1.5;

1.5
date	97.10.31.19.36.48;	author neto;	state Exp;
branches;
next	1.4;

1.4
date	97.10.17.16.38.30;	author neto;	state Exp;
branches;
next	1.3;

1.3
date	97.10.17.15.36.01;	author neto;	state Exp;
branches;
next	1.2;

1.2
date	97.06.25.21.05.28;	author neto;	state Exp;
branches;
next	1.1;

1.1
date	97.06.25.19.45.23;	author neto;	state Exp;
branches;
next	;


desc
@Makefile useful for making plots out of log data.
@


1.8
log
@This now appears to work with the different massage
possibilities.
@
text
@## Process this file with automake to produce Makefile.in
# Makefile for generating plot data from LK output.
# $Id: Makefile.am,v 1.6 1997/11/07 22:20:08 neto Exp neto $
# Requires GNU make (pattern rules, functions).
# vi :set tw=0 sw=4 ts=4:

##   Copyright (C) 1994, 1995, 1996, 1997 David Neto
##
##   This program is free software; you can redistribute it and/or modify
##   it under the terms of the GNU General Public License as published by
##   the Free Software Foundation; either version 2, or (at your option)
##   any later version.
##
##   This program is distributed in the hope that it will be useful,
##   but WITHOUT ANY WARRANTY; without even the implied warranty of
##   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
##   GNU General Public License for more details.
##
##   You should have received a copy of the GNU General Public License
##   along with this program; if not, write to the Free Software
##   Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA
##   02111-1307, USA.

EXTRA_DIST = 0.0

dist-hook : 
	cp -r RCS $(distdir)

scriptdir=../script

comma=,
dollar=\$$


# LK output files names are of the form:
# 	out.<instance-basename>.<massage-key>.<permutation>.<lk-kind>.gz
# e.g.
#	out.dsj1000.c.5.deg.gz

# <massage-key> is of form <rotate><sfc><clone>, where
# 
# <rotate> is r if the instance was rotated instead of having its s cities
# randomly renamed.  Otherwise it is empty
# 
# <sfc> is s if LK reordered the cities by Moore's space-filling curve.
# Otherwise it is empty
#
# <clone> is c if this instance is a clone of the instance instead of the
# original instance itself.  Otherwise it is empty

# <permutation> is a number, usually 0 through 5.  It affects
# the massaging.  If the massage is a random renaming, the number
# is the seed used for the reordering, with 0 being the identity
# permutation.  If the massage is a rotation, the number is the
# number of radians by which the instance is rotated.

# <lk-kind> is one of
# 	no_d indicating no declustering
# 	deg indicating declustering in eligibility test and greedy selection

permnumbers		= 0 1 2 3 4 5
permutations 	= $(foreach n,$(permnumbers),$(massagekey).$(n) )

plotno_d 	=with lines
plotdeg  	=with linespoints
cfplotno_d	=with lines
cfplotdeg	=with points

plotfiles ='$(foreach perm,$(permutations),"$*.$(perm).LKKIND.DATA.gpl" PLOTOPTION$(comma))'

no_dplotfiles	=$(subst PLOTOPTION,$(plotno_d),$(subst LKKIND,no_d,$(plotfiles)))
degplotfiles	=$(subst PLOTOPTION,$(plotdeg),$(subst LKKIND,deg,$(plotfiles)))
plotline 		= plot $(no_dplotfiles) $(degplotfiles)
milemileplotline= plot \"0.0\" with lines, $(no_dplotfiles) $(degplotfiles)

cfno_dplotfiles =$(subst PLOTOPTION,$(cfplotno_d),$(subst LKKIND,no_d,$(plotfiles)))
cfdegplotfiles  =$(subst PLOTOPTION,$(cfplotdeg),$(subst LKKIND,deg,$(plotfiles)))
cfcfplotline    =plot \"0.0\" with lines, $(no_dplotfiles) $(degplotfiles)

mileplotline 	= $(subst DATA,mile,$(milemileplotline))
cfplotline 		= $(subst DATA,cf,$(cfcfplotline))
probeplotline 	= $(subst DATA,probe,$(plotline))
moveplotline 	= $(subst DATA,move,$(plotline))
improveplotline = $(subst DATA,improve,$(plotline))

gpl = if [ -r out.$*.$(perm).$(lkkind).gz ]; then make $*.$(perm).$(lkkind).DATA.gpl ;fi;

cfgpl 	= out.$*.$(perm).$(lkkind)
milegpl 		= $(subst DATA,mile,$(gpl))
probegpl 		= $(subst DATA,probe,$(gpl))
movegpl 		= $(subst DATA,move,$(gpl))
improvegpl 		= $(subst DATA,improve,$(gpl))

allmilegpl 		= $(foreach lkkind,no_d deg,$(milegpl))
allcfgpl 		= $(foreach lkkind,deg no_d,$(cfgpl))
allprobegpl 	= $(foreach lkkind,no_d deg,$(probegpl))
allmovegpl 		= $(foreach lkkind,no_d deg,$(movegpl))
allimprovegpl 	= $(foreach lkkind,no_d deg,$(improvegpl))

plttops = \
	echo set term postscript landscape monochrome >$@@.tmp; \
	grep -v pause <`echo $@@ | sed s/\.ps/\.plt/` >>$@@.tmp; \
	gnuplot $@@.tmp >$@@; \
	rm -f $@@.tmp


%.ps : Makefile %.plt
	$(plttops)

%..cf.plt : Makefile
	make massagekey= $*.cf.plt
%..mile.plt : Makefile
	make massagekey= $*.mile.plt
%..probe.plt : Makefile
	make massagekey= $*.probe.plt
%..improve.plt : Makefile
	make massagekey= $*.improve.plt
%..move.plt : Makefile
	make massagekey= $*.move.plt

%.r.cf.plt : Makefile
	make massagekey=r $*.cf.plt
%.r.mile.plt : Makefile
	make massagekey=r $*.mile.plt
%.r.probe.plt : Makefile
	make massagekey=r $*.probe.plt
%.r.improve.plt : Makefile
	make massagekey=r $*.improve.plt
%.r.move.plt : Makefile
	make massagekey=r $*.move.plt

%.s.cf.plt : Makefile
	make massagekey=s $*.cf.plt
%.s.mile.plt : Makefile
	make massagekey=s $*.mile.plt
%.s.probe.plt : Makefile
	make massagekey=s $*.probe.plt
%.s.improve.plt : Makefile
	make massagekey=s $*.improve.plt
%.s.move.plt : Makefile
	make massagekey=s $*.move.plt

%.c.cf.plt : Makefile
	make massagekey=c $*.cf.plt
%.c.mile.plt : Makefile
	make massagekey=c $*.mile.plt
%.c.probe.plt : Makefile
	make massagekey=c $*.probe.plt
%.c.improve.plt : Makefile
	make massagekey=c $*.improve.plt
%.c.move.plt : Makefile
	make massagekey=c $*.move.plt

%.rs.cf.plt : Makefile
	make massagekey=rs $*.cf.plt
%.rs.mile.plt : Makefile
	make massagekey=rs $*.mile.plt
%.rs.probe.plt : Makefile
	make massagekey=rs $*.probe.plt
%.rs.improve.plt : Makefile
	make massagekey=rs $*.improve.plt
%.rs.move.plt : Makefile
	make massagekey=rs $*.move.plt

%.rc.cf.plt : Makefile
	make massagekey=rc $*.cf.plt
%.rc.mile.plt : Makefile
	make massagekey=rc $*.mile.plt
%.rc.probe.plt : Makefile
	make massagekey=rc $*.probe.plt
%.rc.improve.plt : Makefile
	make massagekey=rc $*.improve.plt
%.rc.move.plt : Makefile
	make massagekey=rc $*.move.plt

%.sc.cf.plt : Makefile
	make massagekey=sc $*.cf.plt
%.sc.mile.plt : Makefile
	make massagekey=sc $*.mile.plt
%.sc.probe.plt : Makefile
	make massagekey=sc $*.probe.plt
%.sc.improve.plt : Makefile
	make massagekey=sc $*.improve.plt
%.sc.move.plt : Makefile
	make massagekey=sc $*.move.plt

%.rsc.cf.plt : Makefile
	make massagekey=rsc $*.cf.plt
%.rsc.mile.plt : Makefile
	make massagekey=rsc $*.mile.plt
%.rsc.probe.plt : Makefile
	make massagekey=rsc $*.probe.plt
%.rsc.improve.plt : Makefile
	make massagekey=rsc $*.improve.plt
%.rsc.move.plt : Makefile
	make massagekey=rsc $*.move.plt


%.cf.plt : Makefile
	zcat $(foreach perm,$(permutations),$(allcfgpl)) | $(scriptdir)/cfresults.pl
	$(foreach perm,$(permnumbers),$(foreach lkkind,deg no_d,mv cf.$(perm).$(lkkind) $*.$(massagekey).$(perm).$(lkkind).cf.gpl; ))
	echo set title \"LK compared with LK+decluster \(% vs. time\)\" >$*.$(massagekey).cf.plt
	echo $(cfplotline) | sed -e s#,$(dollar)##g >>$*.$(massagekey).cf.plt
	echo pause -1 >>$*.$(massagekey).cf.plt

%.mile.plt :
	$(foreach perm,$(permutations),$(allmilegpl))
	echo set title \"Percentage milestones vs. time\" >$*.$(massagekey).mile.plt
	echo $(mileplotline) | sed -e s#,$(dollar)##g >>$*.$(massagekey).mile.plt
	echo pause -1 >>$*.$(massagekey).mile.plt

%.probe.plt :
	$(foreach perm,$(permutations),$(allprobegpl))
	echo set title \"Histogram of probe depths\" >$*.$(massagekey).probe.plt
	echo $(probeplotline) | sed -e s#,$(dollar)##g >>$*.$(massagekey).probe.plt
	echo pause -1 >>$*.$(massagekey).probe.plt

%.move.plt :
	$(foreach perm,$(permutations),$(allmovegpl))
	echo set title \"Histogram of move depths\" >$*.$(massagekey).move.plt
	echo $(moveplotline) | sed -e s#,$(dollar)##g >>$*.$(massagekey).move.plt
	echo pause -1 >>$*.$(massagekey).move.plt

%.improve.plt :
	$(foreach perm,$(permutations),$(allimprovegpl))
	echo set title \"Tour length vs. time\" >$*.$(massagekey).improve.plt
	echo $(improveplotline) | sed -e s#,$(dollar)##g >>$*.$(massagekey).improve.plt
	echo pause -1 >>$*.$(massagekey).improve.plt

%.probe.gpl : out.%.gz
	$(scriptdir)/probe.pl $<
	mv probe.gpl $@@

%.move.gpl %.: out.%.gz
	$(scriptdir)/probe.pl $<
	mv move.gpl $@@

%.mile.gpl %.: out.%.gz
	$(scriptdir)/milestone.pl $<
	mv milestone.gpl $@@

%.improve.gpl %.: out.%.gz
	$(scriptdir)/improve.pl $<
	mv improve.gpl $@@

%.cost.gpl %.: out.%.gz
	$(scriptdir)/cd.pl $<
	mv cost.gpl $@@

%.decd.gpl %.: out.%.gz
	$(scriptdir)/cd.pl $<
	mv decd.gpl $@@

%.prd.gpl %.: out.%.gz
	$(scriptdir)/cd.pl $<
	mv prd.gpl $@@


clean :
	rm -f *.plt

veryclean :  clean
	rm -f *.gpl

@


1.7
log
@Clean up tabs to see the code better.
@
text
@d40 1
a40 1
# The massage key is of form <rotate><sfc><clone>, where
d43 1
a43 1
# randomly renamed.
d46 2
a47 1
# 
d49 1
a49 1
# original instance itself.
d51 1
a51 1
# The permutation is a number, usually 0 through 5.  It affects
d62 1
a62 1
permutations 	= $(foreach n,$(permnumbers),.$(massageprefix)$(n) )
d69 1
a69 1
plotfiles ='$(foreach perm,$(permutations),"$*$(perm).LKKIND.DATA.gpl" PLOTOPTION$(comma))'
d72 1
a72 1
degplotfiles	=$(subst PLOTOPTION,$(plotdeg) ,$(subst LKKIND,deg ,$(plotfiles)))
d77 1
a77 1
cfdegplotfiles  =$(subst PLOTOPTION,$(cfplotdeg) ,$(subst LKKIND,deg ,$(plotfiles)))
d80 12
a91 12
mileplotline 	= $(subst DATA,mile    ,$(milemileplotline))
cfplotline 		= $(subst DATA,cf      ,$(cfcfplotline))
probeplotline 	= $(subst DATA,probe   ,$(plotline))
moveplotline 	= $(subst DATA,move    ,$(plotline))
improveplotline = $(subst DATA,improve ,$(plotline))

gpl = if [ -r out.$*$(perm).$(lkkind).gz ]; then make $*$(perm).$(lkkind).DATA.gpl ;fi;

cfgpl 	= out.$*$(perm).$(lkkind)
milegpl 		= $(subst DATA,mile   ,$(gpl))
probegpl 		= $(subst DATA,probe  ,$(gpl))
movegpl 		= $(subst DATA,move   ,$(gpl))
d107 2
a108 14
%.cf.ps : Makefile %.cf.plt
	$(plttops)	

%.mile.ps : Makefile %.mile.plt
	$(plttops)	

%.improve.ps : %.improve.plt
	$(plttops)	

%.move.ps : %.move.plt
	$(plttops)	

%.probe.ps : %.probe.plt
	$(plttops)	
d111 1
a111 1
	make massageprefix= $*.cf.plt
d113 1
a113 1
	make massageprefix= $*.mile.plt
d115 1
a115 1
	make massageprefix= $*.probe.plt
d117 1
a117 1
	make massageprefix= $*.improve.plt
d119 1
a119 1
	make massageprefix= $*.move.plt
d122 1
a122 1
	make massageprefix=r $*.cf.plt
d124 1
a124 1
	make massageprefix=r $*.mile.plt
d126 1
a126 1
	make massageprefix=r $*.probe.plt
d128 1
a128 1
	make massageprefix=r $*.improve.plt
d130 23
a152 1
	make massageprefix=r $*.move.plt
d155 1
a155 1
	make massageprefix=rs $*.cf.plt
d157 1
a157 1
	make massageprefix=rs $*.mile.plt
d159 1
a159 1
	make massageprefix=rs $*.probe.plt
d161 1
a161 1
	make massageprefix=rs $*.improve.plt
d163 1
a163 1
	make massageprefix=rs $*.move.plt
d165 32
a196 10
%.s.cf.plt : Makefile
	make massageprefix=s $*.cf.plt
%.s.mile.plt : Makefile
	make massageprefix=s $*.mile.plt
%.s.probe.plt : Makefile
	make massageprefix=s $*.probe.plt
%.s.improve.plt : Makefile
	make massageprefix=s $*.improve.plt
%.s.move.plt : Makefile
	make massageprefix=s $*.move.plt
d201 4
a204 4
	$(foreach perm,$(permnumbers),$(foreach lkkind,deg no_d,mv cf.$(perm).$(lkkind) $*.$(massageprefix)$(perm).$(lkkind).cf.gpl; ))
	echo set title \"LK compared with LK+decluster \(% vs. time\)\" >$*.$(massageprefix).cf.plt
	echo $(cfplotline) | sed -e s#,$(dollar)##g >>$*.$(massageprefix).cf.plt
	echo pause -1 >>$*.$(massageprefix).cf.plt
d208 3
a210 3
	echo set title \"Percentage milestones vs. time\" >$*.$(massageprefix).mile.plt
	echo $(mileplotline) | sed -e s#,$(dollar)##g >>$*.$(massageprefix).mile.plt
	echo pause -1 >>$*.$(massageprefix).mile.plt
d214 3
a216 3
	echo set title \"Histogram of probe depths\" >$*.$(massageprefix).probe.plt
	echo $(probeplotline) | sed -e s#,$(dollar)##g >>$*.$(massageprefix).probe.plt
	echo pause -1 >>$*.$(massageprefix).probe.plt
d220 3
a222 3
	echo set title \"Histogram of move depths\" >$*.$(massageprefix).move.plt
	echo $(moveplotline) | sed -e s#,$(dollar)##g >>$*.$(massageprefix).move.plt
	echo pause -1 >>$*.$(massageprefix).move.plt
d226 3
a228 3
	echo set title \"Tour length vs. time\" >$*.$(massageprefix).improve.plt
	echo $(improveplotline) | sed -e s#,$(dollar)##g >>$*.$(massageprefix).improve.plt
	echo pause -1 >>$*.$(massageprefix).improve.plt
@


1.6
log
@Support gzipped log files.
@
text
@d3 1
a3 1
# $Id: Makefile.am,v 1.5 1997/10/31 19:36:48 neto Exp neto $
d5 1
a5 1
# vi :set tw=0:
a30 13
# .no_d is no declustering
# .de is declustering in eligibility test
# .deg is declustering in eligibility test and greedy selection

# massage prefix is 
#	(empty) for city reorderings and no SFC
#	r for rotated instances but no SFC
#	s for SFC and city reorderings
#	rs for SFC and rotations
massageprefix=

permnumbers= 0 1 2 3 4 5
permutations = $(foreach n,$(permnumbers),.$(massageprefix)$(n) )
a32 2
plotno_d=with lines
plotdeg=with linespoints
d34 33
a66 2
cfplotno_d=with lines
cfplotdeg=with points
d70 14
a83 14
no_dplotfiles=$(subst PLOTOPTION,$(plotno_d),$(subst LKKIND,no_d,$(plotfiles)))
degplotfiles=$(subst PLOTOPTION,$(plotdeg),$(subst LKKIND,deg,$(plotfiles)))
plotline =plot $(no_dplotfiles) $(degplotfiles)
milemileplotline =plot \"0.0\" with lines, $(no_dplotfiles) $(degplotfiles)

cfno_dplotfiles=$(subst PLOTOPTION,$(cfplotno_d),$(subst LKKIND,no_d,$(plotfiles)))
cfdegplotfiles=$(subst PLOTOPTION,$(cfplotdeg),$(subst LKKIND,deg,$(plotfiles)))
cfcfplotline =plot \"0.0\" with lines, $(no_dplotfiles) $(degplotfiles)

mileplotline = $(subst DATA,mile,$(milemileplotline))
cfplotline = $(subst DATA,cf,$(cfcfplotline))
probeplotline = $(subst DATA,probe,$(plotline))
moveplotline = $(subst DATA,move,$(plotline))
improveplotline = $(subst DATA,improve,$(plotline))
d86 12
a97 10
milegpl = $(subst DATA,mile,$(gpl))
cfgpl = out.$*$(perm).$(lkkind)
probegpl = $(subst DATA,probe,$(gpl))
movegpl = $(subst DATA,move,$(gpl))
improvegpl = $(subst DATA,improve,$(gpl))
allmilegpl = $(foreach lkkind,no_d deg,$(milegpl))
allcfgpl = $(foreach lkkind,deg no_d,$(cfgpl))
allprobegpl = $(foreach lkkind,no_d deg,$(probegpl))
allmovegpl = $(foreach lkkind,no_d deg,$(movegpl))
allimprovegpl = $(foreach lkkind,no_d deg,$(improvegpl))
@


1.5
log
@Added support for ..cf.plt etc.
@
text
@d3 1
a3 1
# $Id: Makefile.am,v 1.4 1997/10/17 16:38:30 neto Exp $
d69 1
a69 1
gpl = if [ -r out.$*$(perm).$(lkkind) ]; then make $*$(perm).$(lkkind).DATA.gpl ;fi;
d149 1
a149 1
	cat $(foreach perm,$(permutations),$(allcfgpl)) | $(scriptdir)/cfresults.pl
d179 1
a179 2

%.probe.gpl : out.%
d183 1
a183 1
%.move.gpl %.: out.%
d187 1
a187 1
%.mile.gpl %.: out.%
d191 1
a191 1
%.improve.gpl %.: out.%
d195 1
a195 1
%.cost.gpl %.: out.%
d199 1
a199 1
%.decd.gpl %.: out.%
d203 1
a203 1
%.prd.gpl %.: out.%
@


1.4
log
@Added support for making SFC vs. no SFC, Rotate vs. Reorder.
@
text
@d3 1
a3 1
# $Id: Makefile.am,v 1.3 1997/10/17 15:36:01 neto Exp neto $
d102 11
@


1.3
log
@Added support for Bentley-style comparisons (See SODA'90).
Added cost, decd, prd.
@
text
@d3 1
a3 1
# $Id: Makefile.am,v 1.2 1997/06/25 21:05:28 neto Exp neto $
d35 9
a43 1
permutations = .0 .1 .2 .3 .4 .5
d57 1
d63 1
a63 1
mileplotline = $(subst DATA,mile,$(plotline))
d88 2
a93 3
%.cf.ps : Makefile %.cf.plt
	$(plttops)	

d103 33
d139 4
a142 4
	$(foreach perm,$(permutations),$(foreach lkkind,deg no_d,mv cf$(perm).$(lkkind) $*$(perm).$(lkkind).cf.gpl; ))
	echo set title \"LK compared with LK+decluster \(% vs. time\)\" >$@@
	echo $(cfplotline) | sed -e s#,$(dollar)##g >>$@@
	echo pause -1 >>$@@
d146 3
a148 3
	echo set title \"Percentage milestones vs. time\" >$@@
	echo $(mileplotline) | sed -e s#,$(dollar)##g >>$@@
	echo pause -1 >>$@@
d152 3
a154 3
	echo set title \"Histogram of probe depths\" >$@@
	echo $(probeplotline) | sed -e s#,$(dollar)##g >>$@@
	echo pause -1 >>$@@
d158 3
a160 3
	echo set title \"Histogram of move depths\" >$@@
	echo $(moveplotline) | sed -e s#,$(dollar)##g >>$@@
	echo pause -1 >>$@@
d164 3
a166 3
	echo set title \"Tour length vs. time\" >$@@
	echo $(improveplotline) | sed -e s#,$(dollar)##g >>$@@
	echo pause -1 >>$@@
@


1.2
log
@Added titles to the plots.
Added targets for generating PostScript.
@
text
@d3 1
a3 1
# $Id: Makefile.am,v 1.1 1997/06/25 19:45:23 neto Exp neto $
d24 1
d29 1
a29 1
scriptdir=../scripts
d41 3
d45 1
d50 4
d55 1
d62 1
d67 1
d80 4
a83 1
%.mile.ps : %.mile.plt
d95 8
d143 13
@


1.1
log
@Initial revision
@
text
@d3 1
a3 1
# $Id: Makefile.am,v 1.1 1997/06/20 17:53:16 neto Exp neto $
d25 3
d60 19
d82 2
a83 3
	echo $(mileplotline) | sed -e s#,$(dollar)##g >$@@
	set title "Percentage milestones vs. time"
	show title
d88 2
a89 3
	echo $(probeplotline) | sed -e s#,$(dollar)##g >$@@
	set title "Histogram of probe depths"
	show title
d94 2
a95 3
	echo $(moveplotline) | sed -e s#,$(dollar)##g >$@@
	set title "Histogram of move depths"
	show title
d100 2
a101 3
	echo $(improveplotline) | sed -e s#,$(dollar)##g >$@@
	set title "Tour length vs. time"
	show title
d126 1
@
